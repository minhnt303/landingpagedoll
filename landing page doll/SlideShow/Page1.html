<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="icon" href="../Image/SharedImage/Logo.png">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Asap:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./Page1.css">
    <script src="https://use.fontawesome.com/2582abf20b.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>Myou Doll</title>
</head>

<body>
    <div style="width:100%;height: 100%;">
        <div class="load-html" id="NavigationMenu" data-source="../Desktop24/index.html"></div>
        <div class="header-section include-html" data-file="../Desktop24/index.html"></div>
        <!-- <div class="load-html" id="MainBody" data-source="body.html"></div>
        <div class="load-html" id="Footer" data-source="footer.html"></div> -->
        <!-- <ui-include src="../Desktop24/index.html" class="mySlides"></ui-include>
        <ui-include src="https://cors-anywhere.herokuapp.com/https://example.com/index.html" class="mySlides">
        </ui-include> -->
    </div>
    <!-- <script runat=server>
        Platform.Load("core","1");
        HTTPHeader.SetValue("Access-Control-Allow-Methods","POST");
        HTTPHeader.SetValue("Access-Control-Allow-Origin","*");
        </script> -->
    <script>
        function includeHTML() {
            var i, elem, file, xhttp; // Khởi tạo các biến

            // Lấy tất cả các thẻ có class là include-html (Như ở trên mình định nghĩa 2 thẻ để include header/footer)
            var includeFiles = document.getElementsByClassName('include-html');

            // Duyệt vòng lặp từ mảng phần tử ở trên
            for (i = 0; i < includeFiles.length; i++) {
                elem = includeFiles[i]; // Gán biến elem bằng thẻ đang được duyệt
                file = elem.getAttribute("data-file"); // Gán biến file là attribute của thẻ đang được duyệt

                if (file) { // Kiểm tra nếu tồn tại attribute này thì thực hiện tiếp
                    xhttp = new XMLHttpRequest(); // Khởi tạo request
                    xhttp.onreadystatechange = function () {
                        // Lắng nghe event khi request kết thúc
                        if (this.readyState == 4) {
                            // Nếu status là 200 (thành công) thì set nội dung của file vào thẻ đang được duyệt
                            if (this.status == 200) { elem.innerHTML = this.responseText; }

                            // Nếu status 404 (lỗi) thì hiển thị nội dung lỗi không thấy component
                            if (this.status == 404) { elem.innerHTML = "Component not found."; }

                            // Sau khi duyệt xong thẻ này thì xoá class include-html 
                            elem.classList.remove("include-html");

                            // Gọi lại function includeHTML để duyệt tất cả các thẻ có class include-html còn lại
                            includeHTML();
                        }
                    }
                    // Tạo và gửi request
                    xhttp.open("GET", file, true);
                    xhttp.send();
                    return; // Thoát function
                }
            }
        };
        includeHTML();
        
        $(function () {
            $(".load-html").each(function () {
                $(this).load(this.dataset.source);
            });
        });

        var myIndex = 0;
        carousel();

        function carousel() {
            var i;
            var x = document.getElementsByClassName("mySlides");
            for (i = 0; i < x.length; i++) {
                x[i].style.display = "none";
            }
            myIndex++;
            if (myIndex > x.length) { myIndex = 1 }
            x[myIndex - 1].style.display = "block";
            setTimeout(carousel, 2000); // Change image every 2 seconds
        }
    </script>
</body>

</html>